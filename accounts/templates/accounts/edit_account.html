{% extends "main.html" %}
{% load static %}

{% block content %}
<div class="mx-auto max-w-3xl px-4 sm:px-6 lg:px-8 py-10">
  <h1 class="text-2xl font-semibold tracking-tight text-blue-300 text-center">Edit Account</h1>

  {% if form.non_field_errors %}
  <div class="mt-6 rounded-md bg-red-900/40 border border-red-700 p-4 text-red-200 text-sm">{{ form.non_field_errors }}</div>
  {% endif %}

  <form method="POST" class="mt-8 space-y-8">
    {% csrf_token %}

    <!-- Username -->
    <div>
      <label for="{{ form.username.id_for_label }}" class="block mb-2 text-sm font-medium text-gray-200">Username</label>
      {{ form.username }}
      {% if form.username.errors %}<p class="mt-1 text-sm text-red-300">{{ form.username.errors|striptags }}</p>{% endif %}
    </div>

    <!-- Name -->
    <div>
      <label class="block mb-2 text-sm font-medium text-gray-200">Name</label>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          {{ form.fname }}
          {% if form.fname.errors %}<p class="mt-1 text-sm text-red-300">{{ form.fname.errors|striptags }}</p>{% endif %}
        </div>
        <div>
          {{ form.mname }}
          {% if form.mname.errors %}<p class="mt-1 text-sm text-red-300">{{ form.mname.errors|striptags }}</p>{% endif %}
        </div>
        <div>
          {{ form.lname }}
          {% if form.lname.errors %}<p class="mt-1 text-sm text-red-300">{{ form.lname.errors|striptags }}</p>{% endif %}
        </div>
      </div>
    </div>

    <!-- Address -->
    <div>
      <label class="block mb-2 text-sm font-medium text-gray-200">Address</label>
      <div class="grid grid-cols-1 md:grid-cols-12 gap-4">
        <div class="md:col-span-5">{{ form.street1 }}</div>
        <div class="md:col-span-3">{{ form.street2 }}</div>
        <div class="md:col-span-3">{{ form.city }}</div>
        <div class="md:col-span-1">{{ form.state }}</div>
        <div class="md:col-span-2">{{ form.zipcode }}</div>
      </div>
      {% if form.street1.errors or form.city.errors or form.state.errors or form.zipcode.errors %}
      <p class="mt-1 text-sm text-red-300">Please check your address fields.</p>
      {% endif %}
    </div>

    <!-- Contact -->
    <div>
      <label class="block mb-2 text-sm font-medium text-gray-200">Contact Info</label>
      {% if form.mobile.errors or form.home.errors or form.work.errors %}
      <p class="mb-2 text-sm text-red-300">Only numbers allowed for phone numbers. No text or special characters.</p>
      {% endif %}
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          <label class="block mb-1 text-xs text-gray-400">Home #</label>
          {{ form.home }}
          {% if form.home.errors %}<p class="mt-1 text-sm text-red-300">{{ form.home.errors|striptags }}</p>{% endif %}
        </div>
        <div>
          <label class="block mb-1 text-xs text-gray-400">Mobile #</label>
          {{ form.mobile }}
          {% if form.mobile.errors %}<p class="mt-1 text-sm text-red-300">{{ form.mobile.errors|striptags }}</p>{% endif %}
        </div>
        <div>
          <label class="block mb-1 text-xs text-gray-400">Work #</label>
          {{ form.work }}
          {% if form.work.errors %}<p class="mt-1 text-sm text-red-300">{{ form.work.errors|striptags }}</p>{% endif %}
        </div>
      </div>
      <div class="mt-4">
        <label class="block mb-1 text-xs text-gray-400">Email</label>
        {{ form.email }}
        {% if form.email.errors %}<p class="mt-1 text-sm text-red-300">{{ form.email.errors|striptags }}</p>{% endif %}
      </div>
    </div>

    <!-- Contact Preference (radios styled as pills) -->
    <div>
      <p class="mb-2 text-sm font-medium text-gray-200">Contact Preference</p>
      <div class="flex flex-wrap gap-3">
        {% for radio in form.preference %}
        <label class="inline-flex items-center gap-2 rounded-lg border border-teal-400 px-3 py-2 cursor-pointer text-teal-200 hover:bg-teal-900/30">
          {{ radio.tag }}
          <span class="text-sm">{{ radio.choice_label }}</span>
        </label>
        {% endfor %}
      </div>
      {% if form.preference.errors %}<p class="mt-1 text-sm text-red-300">{{ form.preference.errors|striptags }}</p>{% endif %}
    </div>

    {% if request.user.is_staff %}
    <div class="flex items-center gap-3">
      {{ form.is_staff }}
      <label for="{{ form.is_staff.id_for_label }}" class="text-sm text-gray-200">Staff</label>
      {% if form.is_staff.errors %}<p class="mt-1 text-sm text-red-300">{{ form.is_staff.errors|striptags }}</p>{% endif %}
    </div>
    {% endif %}

    <div class="pt-2 flex items-center justify-between">
      <a class="text-sm text-blue-300 underline hover:text-blue-200" href="{% url 'reset_password' %}?next={% url 'edit-account' %}">Reset Password</a>
      <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2.5 rounded-xl shadow transition">Save Changes</button>
    </div>
  </form>
</div>
{% endblock content %}
